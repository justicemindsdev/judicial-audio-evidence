<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Justice Minds - Bereavement Support</title>
    <link rel="stylesheet" href="https://www.gov.uk/assets/govuk-frontend/govuk-frontend-5.4.1.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Courier+Prime:wght@400;700&display=swap');
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: "GDS Transport", arial, sans-serif;
            line-height: 1.5;
            color: #0b0c0c;
            background-color: #f3f2f1;
        }

        .hero-container {
            height: 100vh;
            overflow: hidden;
            position: relative;
            background: #0b0c0c;
        }

        .hero-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            position: absolute;
            top: 0;
            left: 0;
            opacity: 0;
            animation: fadeInZoom 9s ease-in-out forwards;
        }

        @keyframes fadeInZoom {
            0% {
                opacity: 0;
                transform: scale(1.5);
            }
            100% {
                opacity: 0.7;
                transform: scale(1);
            }
        }

        .hero-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .hero-logo {
            max-width: 80%;
            max-height: 40vh;
            opacity: 0;
            animation: fadeInGrow 4s ease-out forwards;
        }

        @keyframes fadeInGrow {
            0% {
                opacity: 0;
                transform: scale(0.8);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        .typewriter-container {
            margin-top: 20px;
            text-align: center;
            opacity: 0;
            animation: fadeInUp 2s ease-out 4s forwards;
        }

        .typewriter-text {
            font-family: 'Courier Prime', monospace;
            font-size: 1.2rem;
            color: #ffffff;
            line-height: 1.6;
            border-right: 2px solid #ffffff;
            padding-right: 10px;
            overflow: hidden;
            white-space: nowrap;
            width: 0;
            animation: typing 9s steps(100) 4s forwards, blink 1s infinite 4s;
        }

        @keyframes typing {
            from { width: 0; }
            to { width: 100%; }
        }

        @keyframes blink {
            50% { border-color: transparent; }
        }

        .start-btn {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 15px 30px;
            font-size: 1.2rem;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            margin-top: 30px;
            opacity: 0;
            animation: fadeIn 1s ease-out 13s forwards;
        }

        .start-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-3px);
        }

        .main-content {
            display: none;
            opacity: 0;
            transition: opacity 1s ease-in-out;
        }

        .main-content.visible {
            display: block;
            opacity: 1;
        }

        .container {
            max-width: 960px;
            margin: 0 auto;
            padding: 20px;
        }

        .govuk-header {
            background-color: #0b0c0c;
            color: white;
            padding: 20px 0;
            margin-bottom: 30px;
        }

        .govuk-header h1 {
            font-size: 2rem;
            font-weight: bold;
        }

        .govuk-phase-banner {
            background-color: #1d70b8;
            color: white;
            padding: 10px 0;
            margin-bottom: 20px;
        }

        .phase-tag {
            background-color: #d4351c;
            color: white;
            padding: 4px 8px;
            font-size: 0.9rem;
            font-weight: bold;
            margin-right: 10px;
        }

        .step-container {
            background-color: white;
            border: 3px solid #1d70b8;
            padding: 30px;
            margin-bottom: 30px;
            border-radius: 4px;
        }

        .step-header {
            background-color: #1d70b8;
            color: white;
            padding: 15px;
            margin: -30px -30px 20px -30px;
            font-size: 1.5rem;
            font-weight: bold;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
            color: #0b0c0c;
        }

        input[type="text"], input[type="email"], input[type="date"], select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #0b0c0c;
            border-radius: 4px;
            font-size: 1rem;
        }

        input[type="radio"], input[type="checkbox"] {
            margin-right: 10px;
        }

        .radio-group, .checkbox-group {
            margin-top: 10px;
        }

        .radio-item, .checkbox-item {
            margin-bottom: 10px;
        }

        .timeline {
            background-color: #f8f8f8;
            border-left: 5px solid #1d70b8;
            padding: 20px;
            margin: 20px 0;
        }

        .timeline-item {
            margin-bottom: 15px;
            padding: 10px;
            border-radius: 4px;
        }

        .timeline-passed {
            background-color: #ffebe6;
            border-left: 3px solid #d4351c;
        }

        .timeline-current {
            background-color: #e6f2ff;
            border-left: 3px solid #1d70b8;
        }

        .timeline-future {
            background-color: #f0f4f5;
            border-left: 3px solid #6f777b;
        }

        .alert {
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .alert-warning {
            background-color: #fff2e6;
            border: 2px solid #f47738;
            color: #b45309;
        }

        .alert-info {
            background-color: #e6f2ff;
            border: 2px solid #1d70b8;
            color: #003078;
        }

        .alert-success {
            background-color: #e6f7e6;
            border: 2px solid #00703c;
            color: #00703c;
        }

        .btn {
            background-color: #00703c;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            font-size: 1rem;
            cursor: pointer;
            margin-right: 10px;
            margin-top: 10px;
        }

        .btn:hover {
            background-color: #005a30;
        }

        .btn-secondary {
            background-color: #6f777b;
        }

        .btn-secondary:hover {
            background-color: #5a6069;
        }

        .toggle-section {
            border: 1px solid #b1b4b6;
            margin: 10px 0;
        }

        .toggle-header {
            background-color: #f3f2f1;
            padding: 15px;
            cursor: pointer;
            border-bottom: 1px solid #b1b4b6;
        }

        .toggle-content {
            padding: 20px;
            display: none;
        }

        .toggle-content.active {
            display: block;
        }

        .file-upload {
            border: 2px dashed #b1b4b6;
            padding: 20px;
            text-align: center;
            margin: 10px 0;
            border-radius: 4px;
        }

        .eligibility-result {
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
            font-weight: bold;
        }

        .eligible {
            background-color: #e6f7e6;
            border: 2px solid #00703c;
            color: #00703c;
        }

        .not-eligible {
            background-color: #ffebe6;
            border: 2px solid #d4351c;
            color: #d4351c;
        }

        .extenuating-circumstances {
            background-color: #fff9e6;
            border: 2px solid #ffb266;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .extenuating-circumstances h3 {
            color: #b45309;
            margin-bottom: 15px;
        }

        .extenuating-circumstances ul {
            margin-left: 20px;
            margin-bottom: 15px;
        }

        .extenuating-circumstances li {
            margin-bottom: 8px;
        }

        .helpline-box {
            background-color: #1d70b8;
            color: white;
            padding: 20px;
            border-radius: 4px;
            text-align: center;
            margin: 20px 0;
        }

        .helpline-box h3 {
            margin-bottom: 10px;
        }

        .helpline-number {
            font-size: 1.5rem;
            font-weight: bold;
            margin: 10px 0;
        }

        .hidden {
            display: none;
        }

        .progress-bar-container {
            width: 100%;
            background-color: #b1b4b6;
            border-radius: 4px;
            margin-bottom: 20px;
        }

        .progress-bar {
            width: 0%;
            height: 20px;
            background-color: #00703c;
            border-radius: 4px;
            text-align: center;
            color: white;
            font-weight: bold;
            line-height: 20px;
            transition: width 0.3s ease-in-out;
        }
    </style>
</head>
<body>
    <div class="hero-container" id="hero">
        <img src="hero_header_final.png" alt="Background" class="hero-image">
        <div class="hero-overlay">
            <img src="logo_header.png" alt="Logo" class="hero-logo">
            <div class="typewriter-container">
                <p class="typewriter-text">Protect what's valuable, validate the hurt, accountability matters, let's work it out together.</p>
            </div>
            <button class="start-btn" id="start-btn">Start</button>
        </div>
    </div>

    <div class="main-content" id="main-content">
        <img src="hero_header_final.png" alt="Header Image" style="width: 100%;" />
        <div class="govuk-header">
            <div class="container">
                <h1>Guardian Bereavement Support</h1>
            </div>
        </div>

        <div class="govuk-phase-banner">
            <div class="container">
                <span class="phase-tag">HELPER</span>
                This tool helps you understand and prepare your Bereavement Support Payment application
            </div>
        </div>

        <div class="container">
            <div class="progress-bar-container">
                <div class="progress-bar" id="progress-bar">0%</div>
            </div>
            <!-- Step 1: Basic Information -->
            <div class="step-container" id="step1">
                <div class="step-header">Step 1: Basic Information</div>
                
                <div class="alert alert-info">
                    <strong>Important:</strong> This is a helper tool to prepare your application. You will still need to submit your official application through GOV.UK, by phone, or by post.
                </div>

                <div class="form-group">
                    <label for="applicant-name">Your Full Name</label>
                    <input type="text" id="applicant-name" name="applicant-name">
                </div>

                <div class="form-group">
                    <label for="applicant-ni">Your National Insurance Number</label>
                    <input type="text" id="applicant-ni" name="applicant-ni" placeholder="e.g. QQ 12 34 56 C">
                </div>

                <div class="form-group">
                    <label for="parent-name">Your Parent's Full Name</label>
                    <input type="text" id="parent-name" name="parent-name">
                </div>

                <div class="form-group">
                    <label for="parent-ni">Your Parent's National Insurance Number</label>
                    <input type="text" id="parent-ni" name="parent-ni" placeholder="e.g. QQ 12 34 56 C">
                </div>

                <div class="form-group">
                    <label for="death-date">Date of Death</label>
                    <input type="date" id="death-date" name="death-date">
                </div>

                <button class="btn" onclick="nextStep(2)">Continue to Step 2</button>
            </div>

            <!-- Step 2: Children and Payment Rate -->
            <div class="step-container hidden" id="step2">
                <div class="step-header">Step 2: Children and Payment Rate</div>

                <div class="form-group">
                    <label>When your parent died, were you under 18 (or under 20 and in full-time education)?</label>
                    <div class="radio-group">
                        <div class="radio-item">
                            <input type="radio" id="higher-rate-yes" name="higher-rate" value="yes" onchange="updatePaymentRate()">
                            <label for="higher-rate-yes">Yes</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="higher-rate-no" name="higher-rate" value="no" onchange="updatePaymentRate()">
                            <label for="higher-rate-no">No</label>
                        </div>
                    </div>
                </div>

                <div id="payment-rate-info" class="alert alert-info" style="display: none;">
                    <!-- Payment rate information will be populated by JavaScript -->
                </div>

                <button class="btn btn-secondary" onclick="previousStep(1)">Previous</button>
                <button class="btn" onclick="nextStep(3)">Continue to Step 3</button>
            </div>

            <!-- Step 3: Timeline and Extenuating Circumstances -->
            <div class="step-container hidden" id="step3">
                <div class="step-header">Step 3: Important Deadlines</div>

                <div id="timeline-container">
                    <!-- Timeline will be populated by JavaScript -->
                </div>

                <div id="extenuating-circumstances-section" style="display: none;">
                    <div class="extenuating-circumstances">
                        <h3>⚠️ You may still be able to claim the full amount</h3>
                        <p><strong>While the 3-month deadline has passed, the Department for Work and Pensions (DWP) can sometimes make exceptions for "extenuating circumstances."</strong></p>
                        
                        <p><strong>Examples of extenuating circumstances include:</strong></p>
                        <ul>
                            <li><strong>Personal or Family Crisis:</strong> You were dealing with serious illness, disability, or family emergency (like a parent's accident)</li>
                            <li><strong>Bereavement Overwhelm:</strong> You were so distressed by the death that you couldn't manage your affairs</li>
                            <li><strong>Incorrect Information:</strong> You were given wrong advice by an official source</li>
                            <li><strong>Practical Difficulties:</strong> You didn't have access to phone/internet or had other barriers</li>
                            <li><strong>Lack of Awareness:</strong> You weren't aware of this benefit or its time limits</li>
                            <li><strong>Caring Responsibilities:</strong> You were overwhelmed caring for children and elderly relatives</li>
                        </ul>

                        <div class="helpline-box">
                            <h3>🚨 ACTION REQUIRED: Call the Bereavement Service</h3>
                            <div class="helpline-number">0800 151 2012</div>
                            <p><strong>Explain your specific circumstances and ask for a discretionary decision about backdating your claim.</strong></p>
                            <p>Have this information ready: your parent's death date, your situation, and why you couldn't claim within 3 months.</p>
                            <p><strong>Open: Monday to Friday, 8am to 6pm</strong></p>
                        </div>

                        <div class="toggle-section">
                            <div class="toggle-header" onclick="toggleSection('what-to-say-guide')">
                                <strong>💡 What to Say When You Call</strong>
                            </div>
                            <div class="toggle-content" id="what-to-say-guide">
                                <p><strong>1. Introduction:</strong> "Hello, my name is [Your Name]. My parent, [Parent's Name], passed away on [Date of Death]. I am calling about making a claim for Bereavement Support Payment."</p>
                                <p><strong>2. Explain the Delay:</strong> "I was unable to claim within the 3-month deadline due to extenuating circumstances."</p>
                                <p><strong>3. State Your Reason Clearly:</strong> Be specific. For example:</p>
                                <ul>
                                    <li>"I was suffering from severe shock and grief and was not able to manage my affairs."</li>
                                    <li>"I was misinformed about the deadline by [source of information, if any]."</li>
                                    <li>"I was dealing with a family crisis at the time..."</li>
                                </ul>
                                <p><strong>4. Request Discretion:</strong> "I would like to ask if you can exercise discretion to consider my claim for the full lump sum payment, given my circumstances."</p>
                                <p><strong>5. Be Prepared:</strong> Have your National Insurance number, your parent's details, and any relevant dates or documents handy.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <button class="btn btn-secondary" onclick="previousStep(2)">Previous</button>
                <button class="btn" onclick="nextStep(4)">Continue to Step 4</button>
            </div>

            <!-- Step 4: Required Documents -->
            <div class="step-container hidden" id="step4">
                <div class="step-header">Step 4: Required Documents</div>

                <p>You will need to provide certain documents with your application. Use the toggles below to see what you need and upload copies if you have them ready:</p>

                <div class="toggle-section">
                    <div class="toggle-header" onclick="toggleSection('death-certificate')">
                        <strong>📄 Death Certificate (Required)</strong>
                    </div>
                    <div class="toggle-content" id="death-certificate">
                        <p>An official copy of the death certificate is required for all applications.</p>
                        <div class="file-upload">
                            <input type="file" id="death-cert-upload" accept=".pdf,.jpg,.jpeg,.png">
                            <p>Upload your death certificate (PDF, JPG, PNG)</p>
                        </div>
                    </div>
                </div>


                <div class="toggle-section">
                    <div class="toggle-header" onclick="toggleSection('child-benefit')">
                        <strong>👶 Child Benefit Documents (If applicable)</strong>
                    </div>
                    <div class="toggle-content" id="child-benefit">
                        <p>If you have children, include Child Benefit award letters or birth certificates.</p>
                        <div class="file-upload">
                            <input type="file" id="child-benefit-upload" accept=".pdf,.jpg,.jpeg,.png" multiple>
                            <p>Upload child benefit documents or birth certificates (PDF, JPG, PNG)</p>
                        </div>
                    </div>
                </div>

                <button class="btn btn-secondary" onclick="previousStep(3)">Previous</button>
                <button class="btn" onclick="nextStep(5)">Continue to Step 5</button>
            </div>

            <!-- Step 5: Funeral Costs and Financial Support -->
            <div class="step-container hidden" id="step5">
                <div class="step-header">Step 5: Funeral Costs and Financial Support</div>

                <div class="alert alert-info">
                    <strong>Understanding Funeral Costs and Financial Support</strong>
                    <p>This section helps you understand how Bereavement Support Payment can help with funeral expenses and financial difficulties.</p>
                </div>

                <div class="form-group">
                    <label for="funeral-cost">What were the total funeral costs? (Optional - for reference only)</label>
                    <input type="number" id="funeral-cost" name="funeral-cost" placeholder="£0">
                </div>

                <div class="form-group">
                    <label>Who paid for the funeral?</label>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="paid-myself" name="funeral-payer" value="myself">
                            <label for="paid-myself">I paid for it myself</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="paid-family" name="funeral-payer" value="family">
                            <label for="paid-family">Family members helped pay</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="paid-loan" name="funeral-payer" value="loan">
                            <label for="paid-loan">I took out a loan</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="paid-other" name="funeral-payer" value="other">
                            <label for="paid-other">Other arrangement</label>
                        </div>
                    </div>
                </div>

                <div class="alert alert-success">
                    <h3>How Bereavement Support Payment Can Help:</h3>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>Immediate Financial Relief:</strong> The lump sum payment can help cover immediate funeral costs</li>
                        <li><strong>Ongoing Support:</strong> 18 monthly payments provide continued financial support</li>
                        <li><strong>Not Means-Tested:</strong> Your savings or income won't affect your eligibility</li>
                        <li><strong>Tax-Free:</strong> All payments are tax-free</li>
                    </ul>
                </div>

                <div class="alert alert-warning">
                    <h3>Additional Support Available:</h3>
                    <p>You may also be eligible for:</p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>Funeral Expenses Payment:</strong> If you're on certain benefits, you may get help with funeral costs</li>
                        <li><strong>Social Fund:</strong> Emergency loans for essential items</li>
                        <li><strong>Local Council Support:</strong> Council Tax reduction or housing benefit</li>
                        <li><strong>Charity Support:</strong> Various charities offer financial help to bereaved families</li>
                    </ul>
                </div>

                <button class="btn btn-secondary" onclick="previousStep(4)">Previous</button>
                <button class="btn" onclick="nextStep(6)">Continue to Step 6</button>
            </div>

            <!-- Step 6: Summary and Next Steps -->
            <div class="step-container hidden" id="step6">
                <div class="step-header">Step 6: Summary and Next Steps</div>

                <div id="eligibility-summary">
                    <!-- Will be populated by JavaScript -->
                </div>

                <div class="alert alert-info">
                    <h3>🎯 Your Next Steps:</h3>
                    <ol style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>Gather your documents</strong> (see the checklist below)</li>
                        <li><strong>Submit your official application</strong> using one of these methods:</li>
                    </ol>
                </div>

                <div class="helpline-box">
                    <h3>📞 Apply by Phone (Recommended for your situation)</h3>
                    <div class="helpline-number">0800 151 2012</div>
                    <p><strong>Bereavement Service helpline</strong></p>
                    <p>Monday to Friday, 8am to 6pm</p>
                    <p>Have all your information and documents ready before calling.</p>
                </div>

                <div class="alert alert-success">
                    <h3>📱 Apply Online:</h3>
                    <p><a href="https://apply-for-bereavement-support-payment.dwp.gov.uk/apply?lang=en" target="_blank" style="color: #00703c; text-decoration: underline;">https://apply-for-bereavement-support-payment.dwp.gov.uk/apply</a></p>
                </div>

                <div id="document-checklist">
                    <h3>📋 Document Checklist:</h3>
                    <div id="checklist-items">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>

                <button class="btn btn-secondary" onclick="previousStep(5)">Previous</button>
                <button class="btn" onclick="saveData()">Save My Information</button>
                <button class="btn btn-secondary" onclick="printSummary()">Print Summary</button>
                <button class="btn" onclick="startOver()">Start Over</button>
            </div>
        </div>
        <img src="footer1.png" alt="Footer Image" style="width: 100%;" />
    </div>

    <script>
        document.getElementById('start-btn').addEventListener('click', function() {
            const hero = document.getElementById('hero');
            const mainContent = document.getElementById('main-content');
            
            hero.style.transition = 'opacity 1s ease-out';
            hero.style.opacity = 0;
            
            setTimeout(() => {
                hero.style.display = 'none';
                mainContent.classList.add('visible');
            }, 1000);
        });

        let formData = {};

        // Load saved data on page load
        window.onload = function() {
            loadSavedData();
        };

        function nextStep(step) {
            // Save current step data
            saveCurrentStep();
            
            // Hide all steps
            document.querySelectorAll('.step-container').forEach(container => {
                container.classList.add('hidden');
            });
            
            // Show target step
            document.getElementById('step' + step).classList.remove('hidden');
            
            // Update specific step content
            if (step === 3) {
                updateTimeline();
            } else if (step === 4) {
                updateDocumentSections();
            } else if (step === 6) {
                updateSummary();
            }
            
            updateProgressBar(step);
            // Scroll to top
            window.scrollTo(0, 0);
        }

        function previousStep(step) {
            document.querySelectorAll('.step-container').forEach(container => {
                container.classList.add('hidden');
            });
            document.getElementById('step' + step).classList.remove('hidden');
            updateProgressBar(step);
            window.scrollTo(0, 0);
        }

        function updateProgressBar(currentStep) {
            const totalSteps = 6;
            const percentage = Math.round(((currentStep -1) / (totalSteps -1)) * 100);
            const progressBar = document.getElementById('progress-bar');
            progressBar.style.width = percentage + '%';
            progressBar.textContent = percentage + '%';
        }

        function saveCurrentStep() {
            // Save all form inputs to formData object
            const inputs = document.querySelectorAll('input, select, textarea');


\            inputs.forEach(input => {
                if (input.type === 'radio' || input.type === 'checkbox') {
                    if (input.checked) {
                        if (input.type === 'checkbox') {
                            if (!formData[input.name]) formData[input.name] = [];
                            formData[input.name].push(input.value);
                        } else {
                            formData[input.name] = input.value;
                        }
                    }
                } else {
                    formData[input.name] = input.value;
                }
            });
        }


        function updatePaymentRate() {
            const higherRate = document.querySelector('input[name="higher-rate"]:checked');
            const paymentInfo = document.getElementById('payment-rate-info');
            
            if (higherRate) {
                paymentInfo.style.display = 'block';
                if (higherRate.value === 'yes') {
                    paymentInfo.innerHTML = `
                        <h3>Higher Rate Payments</h3>
                        <p><strong>You qualify for the higher rate:</strong></p>
                        <ul style="margin-left: 20px;">
                            <li>One-off payment: £3,500</li>
                            <li>18 monthly payments: £350 each</li>
                            <li>Total potential: £9,800</li>
                        </ul>
                    `;
                } else {
                    paymentInfo.innerHTML = `
                        <h3>Lower Rate Payments</h3>
                        <p><strong>You qualify for the lower rate:</strong></p>
                        <ul style="margin-left: 20px;">
                            <li>One-off payment: £2,500</li>
                            <li>18 monthly payments: £100 each</li>
                            <li>Total potential: £4,300</li>
                        </ul>
                    `;
                }
            }
        }

        function updateTimeline() {
            const deathDate = document.getElementById('death-date').value;
            const timelineContainer = document.getElementById('timeline-container');
            const extenuatingSection = document.getElementById('extenuating-circumstances-section');
            
            if (!deathDate) return;
            
            const death = new Date(deathDate);
            const today = new Date();
            const threeMonths = new Date(death);
            threeMonths.setMonth(death.getMonth() + 3);
            const twentyOneMonths = new Date(death);
            twentyOneMonths.setMonth(death.getMonth() + 21);
            
            const daysSinceDeath = Math.floor((today - death) / (1000 * 60 * 60 * 24));
            const daysToThreeMonths = Math.floor((threeMonths - today) / (1000 * 60 * 60 * 24));
            const daysToTwentyOneMonths = Math.floor((twentyOneMonths - today) / (1000 * 60 * 60 * 24));
            
            let timelineHTML = `
                <div class="timeline">
                    <h3>⏰ Important Deadlines</h3>
            `;
            
            // 3-month deadline
            if (today > threeMonths) {
                timelineHTML += `
                    <div class="timeline-item timeline-passed">
                        <strong>❌ 3-Month Deadline (${threeMonths.toLocaleDateString()})</strong>
                        <p>Deadline for full lump sum payment has passed (${Math.abs(daysToThreeMonths)} days ago)</p>
                    </div>
                `;
                extenuatingSection.style.display = 'block';
            } else {
                timelineHTML += `
                    <div class="timeline-item timeline-current">
                        <strong>✅ 3-Month Deadline (${threeMonths.toLocaleDateString()})</strong>
                        <p>You have ${daysToThreeMonths} days left to claim the full lump sum payment</p>
                    </div>
                `;
            }
            
            // 21-month deadline
            if (today > twentyOneMonths) {
                timelineHTML += `
                    <div class="timeline-item timeline-passed">
                        <strong>❌ 21-Month Final Deadline (${twentyOneMonths.toLocaleDateString()})</strong>
                        <p>Final deadline to claim has passed</p>
                    </div>
                `;
            } else {
                timelineHTML += `
                    <div class="timeline-item timeline-future">
                        <strong>📅 21-Month Final Deadline (${twentyOneMonths.toLocaleDateString()})</strong>
                        <p>You have ${daysToTwentyOneMonths} days left to submit your claim</p>
                    </div>
                `;
            }
            
            timelineHTML += `</div>`;
            timelineContainer.innerHTML = timelineHTML;
        }

        function updateDocumentSections() {
            // This function is no longer needed as the relationship section has been removed.
        }

        function toggleSection(sectionId) {
            const content = document.getElementById(sectionId);
            content.classList.toggle('active');
        }

        function updateSummary() {
            const summaryContainer = document.getElementById('eligibility-summary');
            const checklistContainer = document.getElementById('checklist-items');
            
            // Get form data
            const higherRate = document.querySelector('input[name="higher-rate"]:checked');
            const deathDate = document.getElementById('death-date').value;
            
            let isEligible = true;
            let eligibilityText = '';
            
            // Check eligibility
            if (higherRate && higherRate.value === 'no') {
                isEligible = false;
                eligibilityText = 'You may not be eligible as you were not under 18 (or under 20 and in full-time education) when your parent died.';
            }
            
            if (isEligible) {
                const paymentRate = higherRate && higherRate.value === 'yes' ? 'higher' : 'lower';
                const lumpSum = paymentRate === 'higher' ? '£3,500' : '£2,500';
                const monthly = paymentRate === 'higher' ? '£350' : '£100';
                const total = paymentRate === 'higher' ? '£9,800' : '£4,300';
                
                eligibilityText = `
                    <div class="eligibility-result eligible">
                        <h3>✅ You appear to be eligible for Bereavement Support Payment</h3>
                        <p><strong>${paymentRate === 'higher' ? 'Higher' : 'Lower'} rate payments:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>Lump sum: ${lumpSum}</li>
                            <li>18 monthly payments of ${monthly}</li>
                            <li>Total potential: ${total}</li>
                        </ul>
                    </div>
                `;
            } else {
                eligibilityText = `
                    <div class="eligibility-result not-eligible">
                        <h3>❌ Eligibility Concern</h3>
                        <p>${eligibilityText}</p>
                        <p><strong>Recommendation:</strong> Call the Bereavement Service helpline to discuss your specific situation.</p>
                    </div>
                `;
            }
            
            summaryContainer.innerHTML = eligibilityText;
            
            // Generate document checklist
            let checklistHTML = '<ul style="margin-left: 20px;">';
            checklistHTML += '<li>✅ Death certificate</li>';
            
            if (higherRate && higherRate.value === 'yes') {
                checklistHTML += '<li>✅ Proof of age (e.g., birth certificate)</li>';
                checklistHTML += '<li>✅ Proof of full-time education (if applicable)</li>';
            }
            
            checklistHTML += '<li>✅ Your National Insurance number</li>';
            checklistHTML += '<li>✅ Your parent\'s National Insurance number</li>';
            checklistHTML += '<li>✅ Bank account details for payments</li>';
            checklistHTML += '</ul>';
            
            checklistContainer.innerHTML = checklistHTML;
        }

        function saveData() {
            saveCurrentStep();
            localStorage.setItem('bereavementFormData', JSON.stringify(formData));
            alert('Your information has been saved to this browser. You can return to continue your application later.');
        }

        function loadSavedData() {
            const saved = localStorage.getItem('bereavementFormData');
            if (saved) {
                formData = JSON.parse(saved);
                
                // Restore form values
                Object.keys(formData).forEach(key => {
                    const element = document.querySelector(`[name="${key}"]`);
                    if (element) {
                        if (element.type === 'radio' || element.type === 'checkbox') {
                            if (Array.isArray(formData[key])) {
                                formData[key].forEach(value => {
                                    const checkbox = document.querySelector(`[name="${key}"][value="${value}"]`);
                                    if (checkbox) checkbox.checked = true;
                                });
                            } else {
                                const radio = document.querySelector(`[name="${key}"][value="${formData[key]}"]`);
                                if (radio) radio.checked = true;
                            }
                        } else {
                            element.value = formData[key];
                        }
                    }
                });
                
                // Show restore notification
                if (Object.keys(formData).length > 0) {
                    const notification = document.createElement('div');
                    notification.className = 'alert alert-info';
                    notification.innerHTML = '<strong>Previous data restored.</strong> Your previously saved information has been loaded.';
                    document.querySelector('.container').insertBefore(notification, document.querySelector('.step-container'));
                    
                    setTimeout(() => {
                        notification.remove();
                    }, 5000);
                }
            }
        }

        function printSummary() {
            const summaryContent = document.getElementById('eligibility-summary').innerHTML;
            const checklistContent = document.getElementById('document-checklist').innerHTML;
            const applicantName = document.getElementById('applicant-name').value;
            const parentName = document.getElementById('parent-name').value;
            const deathDate = document.getElementById('death-date').value;

            const printWindow = window.open('', '', 'height=600,width=800');
            printWindow.document.write('<html><head><title>Bereavement Support Application Summary</title>');
            printWindow.document.write('<style>body { font-family: sans-serif; } .eligibility-result { padding: 15px; border: 1px solid #ccc; margin-bottom: 15px; } .eligible { background-color: #e6f7e6; } .not-eligible { background-color: #ffebe6; } ul { margin-left: 20px; }</style>');
            printWindow.document.write('</head><body>');
            printWindow.document.write('<h1>Bereavement Support Payment Application Summary</h1>');
            printWindow.document.write(`<p><strong>Applicant:</strong> ${applicantName}</p>`);
            printWindow.document.write(`<p><strong>Deceased Parent:</strong> ${parentName}</p>`);
            printWindow.document.write(`<p><strong>Date of Death:</strong> ${new Date(deathDate).toLocaleDateString()}</p>`);
            printWindow.document.write('<hr>');
            printWindow.document.write(summaryContent);
            printWindow.document.write(checklistContent);
            printWindow.document.write('</body></html>');
            printWindow.document.close();
            printWindow.print();
        }

        function startOver() {
            if (confirm('Are you sure you want to start over? This will clear all your entered information.')) {
                localStorage.removeItem('bereavementFormData');
                location.reload();
            }
        }
    </script>
</body>
</html>
